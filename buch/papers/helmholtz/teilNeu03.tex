%
% teil3.tex -- Beispiel-File für Teil 3
%
% (c) 2020 Prof Dr Andreas Müller, Hochschule Rapperswil
%
% !TEX root = ../../buch.tex
% !TEX encoding = UTF-8
%
\section{Die Helmholtz-Zerlegung
\label{helmholtz:section:Helmholtz_Zerlegung}}
\kopfrechts{Helmholtz-Zerlegung}

Die Grundidee der Helmholtz-Zerlegung besteht darin, dass ein differenzierbares  Vektorfeld $\mathbf{F}$, welches im Unendlichen schnell genug abfällt, sich in zwei orthogonale Komponenten zerlegen lässt: einen eindeutig wirbelfreien Teil und einen quellenfreien Teil. Diese Zerlegung spiegelt die physikalischen Eigenschaften des Vektorfeldes wider und ist insbesondere in der Akustik, Strömungsmechanik und Elektrodynamik von zentraler Bedeutung.

\subsection{Formale Definition der Helmholtz-Zerlegung
\label{helmholtz:subsection:def_Helmholtz_Zerlegung}}

\begin{equation}
\underbrace{\mathbf{F}}_{\text{zu zerlegendes Vektorfeld}} = \underbrace{-\nabla \Phi}_{\text{irrotationaler Teil}} + \underbrace{\nabla \times \mathbf{\Psi}}_{\text{solenoidaler Teil}}
\label{helmholtz:equationAllgemein}
\end{equation}

Die Bedeutung der einzelnen Komponenten lässt sich wie folgt beschreiben:

\begin{itemize}
\item Der erste Term $ -\nabla \Phi $ ist wirbelfrei, da seine Rotation verschwindet.
\begin{itemize}
\item Dieser Anteil hat keine Rotation: $\nabla \times (-\nabla \Phi) = 0$.
\item Die Feldlinien verlaufen strahlenförmig von Quellen zu Senken.
\end{itemize}

\item Der zweite Term $\nabla \times \mathbf{\Psi}$ hat gemäss der Definition immer Divergenz gleich null und wird auch solenoidal genannt.
\begin{itemize}
\item Dieser Anteil hat keine Divergenz: $\nabla \cdot (\nabla \times \mathbf{\Psi}) = 0$.
\item Die Feldlinien bilden geschlossene Schleifen ähnlich einem Magnetfeld.
\end{itemize}
\end{itemize}

\begin{table}
\centering
\begin{tabular}{l|l|l|l}
\hline
\textbf{Komponente} & \textbf{Potential} & \textbf{Eigenschaft} & \textbf{Bezeichnung} \\
\hline 
Irrotationaler Teil & $\Phi$ (Skalarpotential) & $\nabla \times (-\nabla \Phi) = 0$ & wirbelfrei\\
\hline
Solenoidaler Teil & $\mathbf{\Psi}$ (Vektorpotential) & $\nabla \cdot (\nabla \times \mathbf{\Psi}) = 0$ & quellenfrei\\
\hline
\end{tabular}
\caption{Übersicht der Helmholtz-Zerlegung}
\label{tab:helmholtz_overview}
\end{table}

Um die Zerlegung anwenden zu können, müssen die Potentiale $\Phi$ und $\mathbf{\Psi}$ berechnet werden. Dies kann auf verschiedene Weisen erfolgen, abhängig von den Randbedingungen.

\subsection{Mahtematischer Nachweis der Eigenschaften
\label{helmholtz:subsection:math_Nachweis}}

\subsubsection{Nachweis der Wirbelfreiheit des irrotationalen Anteils}
Sei $\Phi$ ein zweimal stetig differenzierbares Skalarfeld.

\begin{enumerate}
    \item Zuerst wird der Gradient $\nabla\Phi$ berechnet:
    Der Gradient ergibt
    $$
    \nabla \Phi =
    \begin{pmatrix}
        \frac{\partial \Phi}{\partial x} \\
        \frac{\partial \Phi}{\partial y} \\
        \frac{\partial \Phi}{\partial z}
    \end{pmatrix}.
    $$

    \item Nun die Rotation dieses Gradientenfeldes:
    
    Die Definitionsformel der Rotation $\nabla \times F$ auf den Gradientenvektor anwenden ergibt
    $$
    \nabla \times (\nabla \Phi) =
    \begin{pmatrix}
        \frac{\partial}{\partial y}\left(\frac{\partial \Phi}{\partial z}\right) - \frac{\partial}{\partial z}\left(\frac{\partial \Phi}{\partial y}\right) \\
        \frac{\partial}{\partial z}\left(\frac{\partial \Phi}{\partial x}\right) - \frac{\partial}{\partial x}\left(\frac{\partial \Phi}{\partial z}\right) \\
        \frac{\partial}{\partial x}\left(\frac{\partial \Phi}{\partial y}\right) - \frac{\partial}{\partial y}\left(\frac{\partial \Phi}{\partial x}\right)
    \end{pmatrix}.
    $$

    \item Den \emph{Satz von Schwarz} anwenden:
    
    Zur besseren Übersicht werden die gemischten Ableitungen ausgeschrieben:
    $$
    =
    \begin{pmatrix}
        \frac{\partial^2 \Phi}{\partial y \partial z} - \frac{\partial^2 \Phi}{\partial z \partial y} \\
        \frac{\partial^2 \Phi}{\partial z \partial x} - \frac{\partial^2 \Phi}{\partial x \partial z} \\
        \frac{\partial^2 \Phi}{\partial x \partial y} - \frac{\partial^2 \Phi}{\partial y \partial x}
    \end{pmatrix}.
    $$
    Der \emph{Satz von Schwarz} besagt, dass bei stetigen Funktionen die Reihenfolge der partiellen Ableitungen vertauscht werden kann. Damit heben sich die Terme in jeder Komponente gegenseitig auf zu
    $$
    =
    \begin{pmatrix}
        0 \\
        0 \\
        0
    \end{pmatrix} = \mathbf{0}.
    $$
\end{enumerate}

\subsubsection{Nachweis der Quellenfreiheit des solenoidalen Anteils}

\begin{enumerate}
    \item Berechnung der Rotation $\nabla \times \mathbf{\Psi}$:
    
    Zuerst wird der Rotations-Operator auf $\mathbf{\Psi}$ angewendet:
    \[
    \nabla \times \mathbf{\Psi} =
    \begin{pmatrix}
        \frac{\partial \Psi_z}{\partial y} - \frac{\partial \Psi_y}{\partial z} \\
        \frac{\partial \Psi_x}{\partial z} - \frac{\partial \Psi_z}{\partial x} \\
        \frac{\partial \Psi_y}{\partial x} - \frac{\partial \Psi_x}{\partial y}
    \end{pmatrix}.
    \]

    \item Berechnung der Divergenz des Ergebnisses:
    
    Nun wird der Divergenz-Operator auf das resultierende Vektorfeld angewendet. Dies geschieht durch die Summe der partiellen Ableitungen der Komponenten nach der jeweiligen Koordinate.
    
    \begin{align*}
    % Schritt 1: Definition der Divergenz anwenden
    \nabla \cdot (\nabla \times \mathbf{\Psi}) &= \frac{\partial}{\partial x}\left( \frac{\partial \Psi_z}{\partial y} - \frac{\partial \Psi_y}{\partial z} \right) + \frac{\partial}{\partial y}\left( \frac{\partial \Psi_x}{\partial z} - \frac{\partial \Psi_z}{\partial x} \right) + \frac{\partial}{\partial z}\left( \frac{\partial \Psi_y}{\partial x} - \frac{\partial \Psi_x}{\partial y} \right) \\[1em]
    % Schritt 2: Die Ableitungen ausführen
    &= \frac{\partial^2 \Psi_z}{\partial x \partial y} - \frac{\partial^2 \Psi_y}{\partial x \partial z} + \frac{\partial^2 \Psi_x}{\partial y \partial z} - \frac{\partial^2 \Psi_z}{\partial y \partial x} + \frac{\partial^2 \Psi_y}{\partial z \partial x} - \frac{\partial^2 \Psi_x}{\partial z \partial y} \\[1em]
    % Schritt 3: Terme umsortieren, um Paare zu bilden
    &= \left( \frac{\partial^2 \Psi_x}{\partial y \partial z} - \frac{\partial^2 \Psi_x}{\partial z \partial y} \right) + \left( \frac{\partial^2 \Psi_y}{\partial z \partial x} - \frac{\partial^2 \Psi_y}{\partial x \partial z} \right) + \left( \frac{\partial^2 \Psi_z}{\partial x \partial y} - \frac{\partial^2 \Psi_z}{\partial y \partial x} \right) = 0.
    \end{align*}
    
    \item Anwendung des \emph{Satzes von Schwarz}:
    
    Nach dem \emph{Satz von Schwarz} ist die Reihenfolge der partiellen Ableitungen bei zweimal stetig differenzierbaren Funktionen irrelevant. Daher gilt:
    \[
    \frac{\partial^2 f}{\partial x \partial y} = \frac{\partial^2 f}{\partial y \partial x}.
    \]
    Angewendet auf die obige Gleichung bedeutet dies, dass jeder Term in den Klammern Null ergibt:
    \begin{align*}
    \nabla \cdot (\nabla \times \mathbf{\Psi}) &= \underbrace{\left( \frac{\partial^2 \Psi_x}{\partial y \partial z} - \frac{\partial^2 \Psi_x}{\partial y \partial z} \right)}_{=0} + \underbrace{\left( \frac{\partial^2 \Psi_y}{\partial z \partial x} - \frac{\partial^2 \Psi_y}{\partial z \partial x} \right)}_{=0} + \underbrace{\left( \frac{\partial^2 \Psi_z}{\partial x \partial y} - \frac{\partial^2 \Psi_z}{\partial x \partial y} \right)}_{=0} \\[1em]
    &= 0 + 0 + 0 \\[1em]
    &= 0.
    \end{align*}
\end{enumerate}

\textbf{Ergebnis:} Damit ist die Identität $\nabla \cdot (\nabla \times \mathbf{\Psi}) = 0$ bewiesen.


\subsection{Berechnung der Potentiale
\label{helmholtz:subsection:Berechnung der Potentiale}}

\subsubsection{Greenscher Ansatz}

Ein möglicher Ansatz zur Lösung der partiellen Differentialgleichung ist die Verwendung der Dirac-Delta-Funktion und des Greenschen Funktionen wie es in \cite{baird_helmholtz} beschrieben ist. Dies entspricht der Integralform einer Matrixmultiplikation. Dabei wird die Funktion $\mathbf{F}$, die in diesem Fall einen Vektor darstellt, mit der Delta-Funktion multipliziert wie folgt:

\begin{equation}
\Delta F = -4 \pi \rho. 
\label{helmholtz:DGL_idee}
\end{equation}

\begin{equation}
\underbrace{\frac{1}{4 \pi} \Delta F}_{invertiert} = \rho 
\label{helmholtz:DGL_idee_umformung}
\end{equation}

\begin{table}
\centering
\begin{tabular}{ll}
  & Idee in Matrixnotation \\
$\Delta F = -4 \pi \rho$  & $Au = f$ \\
$\underbrace{\frac{1}{4 \pi} \Delta F}_{invertiert} = \rho$ & $A^{-1}Au = A^{-1}f$  \\
 & $u = A^{-1}f$  \\
\end{tabular}
\caption{Analogie zur Matrixinversion}
\end{table}

Grundlegend für diesen Ansatz ist die Beziehung:

\begin{equation}
\delta (\mathbf{x} - \mathbf{x'}) = \frac{1}{4 \pi} \nabla^2 \frac{1}{|\mathbf{x} - \mathbf{x'}|}
\label{helmholtz:dirac}
\end{equation}

Diese Beziehung lässt sich analog zur Multiplikation mit der Einheitsmatrix verstehen.

\begin{equation}
\mathbf{F}(\mathbf{r}) = -\frac{1}{4\pi} \int_V \mathbf{F}(\mathbf{r}') \nabla^2 \left( \frac{1}{|\mathbf{r} - \mathbf{r}'|} \right) dV'
\end{equation}

Unter Verwendung der Vektoridentität:

\begin{equation}
\nabla^2 \mathbf{\Psi}= \underbrace{\nabla \Big( \nabla \cdot \mathbf{\Psi} \Big)}_{\text{Gradient}} -\underbrace{\nabla \times \Big(\nabla \times \mathbf{\Psi} \Big)}_{\text{Rotation}},
\end{equation}

kann das Vektorfeld $\mathbf{F}$ geschrieben werden als:

\begin{equation}
\mathbf{F}(\mathbf{r}) = - \frac{1}{4 \pi} \nabla \bigg( \nabla \cdot \int_V \frac{\mathbf{F}(\mathbf{x}^{\prime})}{|\mathbf{r} - \mathbf{r}^{\prime}|} d\mathbf{x}^{\prime} \bigg) + \frac{1}{4 \pi} \nabla \times \bigg( \nabla \times \int_V \frac{\mathbf{F}(\mathbf{x}^{\prime})}{|\mathbf{r} - \mathbf{r}^{\prime}|} d\mathbf{x}^{\prime} \bigg).
\end{equation}

\noindent Diese Gleichung repräsentiert die Helmholtz-Zerlegung des Vektorfeldes $\mathbf{F}$.

\subsubsection{Berechnung der Potentiale in unbeschränkten Gebieten}

Die Potentiale $\Phi$ und $\mathbf{\Psi}$ lassen sich für unbeschränkte Gebiete mit Hilfe der Greenschen Funktion wie folgt berechnen:

\begin{itemize}
\item \textbf{Skalares Potential:}
\begin{equation}
\Phi(\mathbf{r}) = \frac{1}{4 \pi} \int_{V} \frac{\nabla' \cdot \mathbf{F}(\mathbf{r'})}{|\mathbf{r} - \mathbf{r'}|} dV'
\end{equation}

\item \textbf{Vektorpotential:}
\begin{equation}
\mathbf{\Psi}(\mathbf{r}) = \frac{1}{4 \pi} \int_{V} \frac{\nabla' \times \mathbf{F}(\mathbf{r'})}{|\mathbf{r} - \mathbf{r'}|} dV'
\end{equation}
\end{itemize}

Hier bezeichnet $\nabla'$ den Nabla-Operator bezüglich der Integrationsvariablen $\mathbf{r'}$.

\subsubsection{Berechnung der Potentiale in beschränkten Gebieten}

Für endliche Volumina $V$ mit Oberfläche $S$ müssen zusätzliche Oberflächenintegrale berücksichtigt werden:

\begin{itemize}
\item \textbf{Skalares Potential:}
\begin{equation}
\Phi (\mathbf{r}) = \frac{1}{4\pi} \int_V \frac{\nabla' \cdot \mathbf{F}(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} dV' + \frac{1}{4\pi} \oint_S \frac{\mathbf{F}(\mathbf{r}') \cdot \mathbf{n}}{|\mathbf{r} - \mathbf{r}'|} dS'
\end{equation}

\item \textbf{Vektorpotential:}
\begin{equation}
\mathbf{\Psi}(\mathbf{r}) = \frac{1}{4\pi} \int_V \frac{\nabla' \times \mathbf{F}(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} dV' + \frac{1}{4\pi} \oint_S \frac{\mathbf{n} \times \mathbf{F}(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} dS'
\end{equation}
\end{itemize}

Hier bezeichnet $\mathbf{n}$ den nach aussen gerichteten Normalenvektor auf der Oberfläche $S$.

\subsection{Bedingungen und Eindeutigkeit
\label{helmholtz:subsection:Bedingungen_Eindeutigkeit}}

\subsubsection{Voraussetzungen für die Anwendbarkeit}
Damit die Zerlegung korrekt durchgeführt werden kann, muss das Vektorfeld $\mathbf{F}$ folgende Bedingungen erfüllen:

\begin{itemize}
\item \textbf{Glattheit:} $\mathbf{F}$ muss stetig differenzierbar sein in dem betrachteten Gebiet.
\item \textbf{Abfallverhalten:} $\mathbf{F}$ muss im Unendlichen schneller als $\frac{1}{r}$ abfallen, d.h.:
\begin{equation}
\lim_{r \to \infty} r|\mathbf{F}(\mathbf{r})| = 0
\end{equation}
wobei $r = |\mathbf{r}|$ der Abstand vom Ursprung ist.
\end{itemize}

\noindent Diese Bedingungen stellen sicher, dass die Integrale in der Greenschen Formulierung konvergieren und die Zerlegung eindeutig ist.

\subsubsection{Eindeutigkeit der Zerlegung}

Die Eindeutigkeit der Helmholtz-Zerlegung hängt von den Randbedingungen ab:

\begin{itemize}
\item \textbf{Für unbeschränkte Gebiete:} Die Zerlegung ist eindeutig, wenn das Vektorfeld im Unendlichen schnell abfällt (schneller als $1/r$).

\item \textbf{Für beschränkte Gebiete:} Die Eindeutigkeit erfordert zusätzliche Randbedingungen, typischerweise:
  \begin{itemize}
    \item Festlegung der Normalkomponente des irrotationalen Teils auf dem Rand.
    \item Festlegung der Tangentialkomponente des solenoidalen Teils auf dem Rand.
  \end{itemize}
\end{itemize}

\subsubsection{Orthogonalität der Komponenten}

Eine wichtige Eigenschaft der Helmholtz-Zerlegung ist die Orthogonalität der beiden Komponenten. Für ein Vektorfeld $\mathbf{F} = \mathbf{F}_{\text{irr}} + \mathbf{F}_{\text{sol}}$ gilt unter geeigneten Randbedingungen:

\begin{equation}
\int_V \mathbf{F}_{\text{irr}} \cdot \mathbf{F}_{\text{sol}} \, dV = 0.
\end{equation}

Dies bedeutet, dass der irrotationale und der solenoidale Teil energetisch entkoppelt sind.


