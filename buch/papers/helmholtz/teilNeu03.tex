%
% teil3.tex -- Beispiel-File für Teil 3
%
% (c) 2020 Prof Dr Andreas Müller, Hochschule Rapperswil
%
% !TEX root = ../../buch.tex
% !TEX encoding = UTF-8
%
\section{Die Helmholtz-Zerlegung
\label{helmholtz:section:Helmholtz_Zerlegung}}
\kopfrechts{Helmholtz-Zerlegung}

Die Grundidee der Helmholtz-Zerlegung besteht darin, dass ein differenzierbares  Vektorfeld $\boldsymbol{F}$, welches im Unendlichen schnell genug abfällt, sich in zwei in noch zu spezifizierendem Sinne orthogonale Komponenten zerlegen lässt: einen eindeutig wirbelfreien Teil und einen quellenfreien Teil. Diese Zerlegung spiegelt die physikalischen Eigenschaften des Vektorfeldes wider und ist insbesondere in der Akustik, Strömungsmechanik und Elektrodynamik von zentraler Bedeutung.

\subsection{Formale Definition der Helmholtz-Zerlegung
\label{helmholtz:subsection:def_Helmholtz_Zerlegung}}

Mit der Idee der Helmholtz-Zerlegung wird das Vektorfeld geschrieben als
\begin{equation}
\underbrace{\boldsymbol{F}}_{\text{zu zerlegendes Vektorfeld}} = \underbrace{-\nabla \Phi}_{\text{irrotationaler Teil}} + \underbrace{\nabla \times \boldsymbol{\Psi}}_{\text{solenoidaler Teil}} 
\label{helmholtz:equationAllgemein}
\end{equation}
und die einzelnen Komponenten lässt sich wie folgt beschreiben:

\begin{itemize}
\item Der erste Term $ -\nabla \Phi $ ist wirbelfrei, da seine Rotation verschwindet.
\begin{itemize}
\item Dieser Anteil hat keine Rotation: $\nabla \times (-\nabla \Phi) = 0$.
\item Die Feldlinien verlaufen strahlenförmig von Quellen zu Senken.
\end{itemize}

\item Der zweite Term $\nabla \times \boldsymbol{\Psi}$ hat gemäss der Definition immer Divergenz gleich null und wird auch solenoidal genannt.
\begin{itemize}
\item Dieser Anteil hat keine Divergenz: $\nabla \cdot (\nabla \times \boldsymbol{\Psi}) = 0$.
\item Die Feldlinien bilden geschlossene Schleifen ähnlich einem Magnetfeld.
\end{itemize}
\end{itemize}

\begin{table}
\centering
\begin{tabular}{l|l|l|l}
\hline
Komponente & Potential & Eigenschaft & Bezeichnung \\
\hline 
Irrotationaler Teil & $\Phi$ (Skalarpotential) & $\nabla \times (-\nabla \Phi) = 0$ & wirbelfrei\\
Solenoidaler Teil & $\boldsymbol{\Psi}$ (Vektorpotential) & $\nabla \cdot (\nabla \times \boldsymbol{\Psi}) = 0$ & quellenfrei\\
\hline
\end{tabular}
\caption{Übersicht der Helmholtz-Zerlegung}
\label{tab:helmholtz_overview}
\end{table}

In der Tabelle \ref{tab:helmholtz_overview} ist die komplementäre Eigeschaft, die Bezeichnung und die Potentialbeschreibung der jeqeiligen Komponenten zusammengefasst.

Um die Zerlegung anwenden zu können, müssen die Potentiale $\Phi$ und $\boldsymbol{\Psi}$ berechnet werden. Dies kann auf verschiedene Weisen erfolgen, abhängig von den Randbedingungen.

\subsection{Mathematischer Nachweis der Eigenschaften
\label{helmholtz:subsection:math_Nachweis}}

\subsubsection{Nachweis der Wirbelfreiheit des irrotationalen Anteils}
Sei $\Phi$ ein zweimal stetig differenzierbares Skalarfeld.

\begin{enumerate}
    \item Zuerst wird der Gradient $\nabla\Phi$ berechnet:
    Der Gradient ergibt
    $$
    \nabla \Phi =
    \begin{pmatrix}
        \frac{\partial \Phi}{\partial x} \\
        \frac{\partial \Phi}{\partial y} \\
        \frac{\partial \Phi}{\partial z}
    \end{pmatrix}.
    $$

    \item Nun die Rotation dieses Gradientenfeldes: Die Definitionsformel der Rotation $\nabla \times F$ auf den Gradientenvektor anwenden ergibt
    $$
    \nabla \times (\nabla \Phi) =
    \begin{pmatrix}
        \frac{\partial}{\partial y}\left(\frac{\partial \Phi}{\partial z}\right) - \frac{\partial}{\partial z}\left(\frac{\partial \Phi}{\partial y}\right) \\
        \frac{\partial}{\partial z}\left(\frac{\partial \Phi}{\partial x}\right) - \frac{\partial}{\partial x}\left(\frac{\partial \Phi}{\partial z}\right) \\
        \frac{\partial}{\partial x}\left(\frac{\partial \Phi}{\partial y}\right) - \frac{\partial}{\partial y}\left(\frac{\partial \Phi}{\partial x}\right)
    \end{pmatrix}.
    $$

    \item %Den \emph{Satz von Schwarz} anwenden:
    
    Zur besseren Übersicht werden die gemischten Ableitungen ausgeschrieben:
    $$
    \nabla \times (\nabla \Phi) =
    \begin{pmatrix}
        \frac{\partial^2 \Phi}{\partial y \partial z} - \frac{\partial^2 \Phi}{\partial z \partial y} \\
        \frac{\partial^2 \Phi}{\partial z \partial x} - \frac{\partial^2 \Phi}{\partial x \partial z} \\
        \frac{\partial^2 \Phi}{\partial x \partial y} - \frac{\partial^2 \Phi}{\partial y \partial x}
    \end{pmatrix}.
    $$
    Der \emph{Satz von Schwarz} besagt, dass bei stetigen Funktionen die Reihenfolge der partiellen Ableitungen vertauscht werden kann. Damit heben sich die Terme in jeder Komponente gegenseitig auf und es bleibt
    $$
    \nabla \times (\nabla \Phi)  =
    \begin{pmatrix}
        0 \\
        0 \\
        0
    \end{pmatrix} = \boldsymbol{0}.
    $$
\end{enumerate}

\subsubsection{Nachweis der Quellenfreiheit des solenoidalen Anteils}

\begin{enumerate}
    \item Berechnung der Rotation $\nabla \times \boldsymbol{\Psi}$: Zuerst wird der Rotations-Operator auf $\boldsymbol{\Psi}$ angewendet:
    \[
    \nabla \times \boldsymbol{\Psi} =
    \begin{pmatrix}
        \frac{\partial \Psi_z}{\partial y} - \frac{\partial \Psi_y}{\partial z} \\
        \frac{\partial \Psi_x}{\partial z} - \frac{\partial \Psi_z}{\partial x} \\
        \frac{\partial \Psi_y}{\partial x} - \frac{\partial \Psi_x}{\partial y}
    \end{pmatrix}.
    \]

    \item Berechnung der Divergenz des Ergebnisses: Nun wird der Divergenz-Operator auf das resultierende Vektorfeld angewendet. Dies geschieht durch die Summe der partiellen Ableitungen der Komponenten nach der jeweiligen Koordinate.
    
    \begin{align*}
    % Schritt 1: Definition der Divergenz anwenden
    \nabla \cdot (\nabla \times \boldsymbol{\Psi}) &= \frac{\partial}{\partial x}\left( \frac{\partial \Psi_z}{\partial y} - \frac{\partial \Psi_y}{\partial z} \right) + \frac{\partial}{\partial y}\left( \frac{\partial \Psi_x}{\partial z} - \frac{\partial \Psi_z}{\partial x} \right) + \frac{\partial}{\partial z}\left( \frac{\partial \Psi_y}{\partial x} - \frac{\partial \Psi_x}{\partial y} \right) \\[1em]
    % Schritt 2: Die Ableitungen ausführen
    &= \frac{\partial^2 \Psi_z}{\partial x \partial y} - \frac{\partial^2 \Psi_y}{\partial x \partial z} + \frac{\partial^2 \Psi_x}{\partial y \partial z} - \frac{\partial^2 \Psi_z}{\partial y \partial x} + \frac{\partial^2 \Psi_y}{\partial z \partial x} - \frac{\partial^2 \Psi_x}{\partial z \partial y} \\[1em]
    % Schritt 3: Terme umsortieren, um Paare zu bilden
    &= \left( \frac{\partial^2 \Psi_x}{\partial y \partial z} - \frac{\partial^2 \Psi_x}{\partial z \partial y} \right) + \left( \frac{\partial^2 \Psi_y}{\partial z \partial x} - \frac{\partial^2 \Psi_y}{\partial x \partial z} \right) + \left( \frac{\partial^2 \Psi_z}{\partial x \partial y} - \frac{\partial^2 \Psi_z}{\partial y \partial x} \right) = 0.
    \end{align*}
    
    \item Nach dem \emph{Satz von Schwarz} ist die Reihenfolge der partiellen Ableitungen bei zweimal stetig differenzierbaren Funktionen irrelevant. Daher gilt:
    \[
    \frac{\partial^2 f}{\partial x \partial y} = \frac{\partial^2 f}{\partial y \partial x}.
    \]
    Angewendet auf die obige Gleichung bedeutet dies, dass jeder Term in den Klammern Null ergibt:
    \begin{align*}
    \nabla \cdot (\nabla \times \boldsymbol{\Psi}) &= \underbrace{\left( \frac{\partial^2 \Psi_x}{\partial y \partial z} - \frac{\partial^2 \Psi_x}{\partial y \partial z} \right)}_{=0} + \underbrace{\left( \frac{\partial^2 \Psi_y}{\partial z \partial x} - \frac{\partial^2 \Psi_y}{\partial z \partial x} \right)}_{=0} + \underbrace{\left( \frac{\partial^2 \Psi_z}{\partial x \partial y} - \frac{\partial^2 \Psi_z}{\partial x \partial y} \right)}_{=0} \\[1em]
    &= 0 + 0 + 0 \\[1em]
    &= 0.
    \end{align*}
\end{enumerate}
Damit ist die Identität $\nabla \cdot (\nabla \times \boldsymbol{\Psi}) = 0$ bewiesen.


\subsection{Berechnung der Potentiale
\label{helmholtz:subsection:Berechnung der Potentiale}}

\subsubsection{Greenscher Ansatz}

Ein möglicher Ansatz zur Lösung der partiellen Differentialgleichung ist die Verwendung der Dirac-Delta-Funktion und des Greenschen Funktionen wie es in \cite{baird_helmholtz} beschrieben ist. Dies entspricht der Integralform einer Matrixmultiplikation, wie in Tabelle \ref{tab:helmholtz_matrix_analogie} 
veranschaulicht. Dabei wird die Funktion $\boldsymbol{F}$, die in diesem Fall einen Vektor darstellt, mit der Delta-Funktion multipliziert wie folgt:

\begin{equation}
\Delta F = -4 \pi \rho. 
\label{helmholtz:DGL_idee}
\end{equation}

\begin{equation}
\underbrace{\frac{1}{4 \pi} \Delta F}_{\text{invertiert}} = \rho 
\label{helmholtz:DGL_idee_umformung}
\end{equation}

\begin{table}
\centering
\begin{tabular}{l|l}
  & Idee in Matrixnotation \\
\hline
$\Delta F = -4 \pi \rho$  & $Au = f$ \\
$\underbrace{\frac{1}{4 \pi} \Delta F}_{invertiert} = \rho$ & $A^{-1}Au = A^{-1}f$  \\
 & $u = A^{-1}f$  \\
 \hline
\end{tabular}
\caption{Analogie zur Matrixinversion}
\label{tab:helmholtz_matrix_analogie}
\end{table}

Grundlegend für diesen Ansatz ist die Beziehung
\begin{equation}
\delta (\boldsymbol{x} - \boldsymbol{x'}) = \frac{1}{4 \pi} \nabla^2 \frac{1}{|\boldsymbol{x} - \boldsymbol{x'}|}.
\label{helmholtz:dirac}
\end{equation}
Diese Beziehung lässt sich analog zur Multiplikation mit der Einheitsmatrix verstehen, was es ermöglicht, das Vektorfeld $\boldsymbol{F}$ durch das Volumenintegral
\begin{equation}
\boldsymbol{F}(\boldsymbol{r}) = -\frac{1}{4\pi} \int_V \boldsymbol{F}(\boldsymbol{r}') \nabla^2 \left( \frac{1}{|\boldsymbol{r} - \boldsymbol{r}'|} \right) dV'
\end{equation}
auszudrücken.

Unter Verwendung der Vektoridentität
\begin{equation}
\nabla^2 \boldsymbol{\Psi}= \underbrace{\nabla \Big( \nabla \cdot \boldsymbol{\Psi} \Big)}_{\text{Gradient}} -\underbrace{\nabla \times \Big(\nabla \times \boldsymbol{\Psi} \Big)}_{\text{Rotation}},
\end{equation}
kann das Vektorfeld $\boldsymbol{F}$ geschrieben werden als:
\begin{equation}
\boldsymbol{F}(\boldsymbol{r}) = - \frac{1}{4 \pi} \nabla ( \nabla \cdot \int_V \frac{\boldsymbol{F}(\boldsymbol{x}^{\prime})}{|\boldsymbol{r} - \boldsymbol{r}^{\prime}|} d\boldsymbol{x}^{\prime} ) + \frac{1}{4 \pi} \nabla \times ( \nabla \times \int_V \frac{\boldsymbol{F}(\boldsymbol{x}^{\prime})}{|\boldsymbol{r} - \boldsymbol{r}^{\prime}|} d\boldsymbol{x}^{\prime} ).
\end{equation}
Diese Gleichung repräsentiert die Helmholtz-Zerlegung des Vektorfeldes $\boldsymbol{F}$.

\subsubsection{Berechnung der Potentiale in unbeschränkten Gebieten}

Die Potentiale $\Phi$ und $\boldsymbol{\Psi}$ lassen sich für unbeschränkte Gebiete mit Hilfe der Greenschen Funktion wie folgt berechnen:

\begin{itemize}
\item Skalares Potential:
\begin{equation}
\Phi(\boldsymbol{r}) = \frac{1}{4 \pi} \int_{V} \frac{\nabla' \cdot \boldsymbol{F}(\boldsymbol{r'})}{|\boldsymbol{r} - \boldsymbol{r'}|} dV'
\end{equation}

\item Vektorpotential:
\begin{equation}
\boldsymbol{\Psi}(\boldsymbol{r}) = \frac{1}{4 \pi} \int_{V} \frac{\nabla' \times \boldsymbol{F}(\boldsymbol{r'})}{|\boldsymbol{r} - \boldsymbol{r'}|} dV'
\end{equation}
\end{itemize}
Hier bezeichnet $\nabla'$ den Nabla-Operator bezüglich der Integrationsvariablen $\boldsymbol{r'}$.

\subsubsection{Berechnung der Potentiale in beschränkten Gebieten}

Für endliche Volumina $V$ mit Oberfläche $S$ müssen zusätzliche Oberflächenintegrale berücksichtigt werden:

\begin{itemize}
\item Skalares Potential:
\begin{equation}
\Phi (\boldsymbol{r}) = \frac{1}{4\pi} \int_V \frac{\nabla' \cdot \boldsymbol{F}(\boldsymbol{r}')}{|\boldsymbol{r} - \boldsymbol{r}'|} dV' + \frac{1}{4\pi} \oint_S \frac{\boldsymbol{F}(\boldsymbol{r}') \cdot \boldsymbol{n}}{|\boldsymbol{r} - \boldsymbol{r}'|} dS'
\end{equation}

\item Vektorpotential:
\begin{equation}
\boldsymbol{\Psi}(\boldsymbol{r}) = \frac{1}{4\pi} \int_V \frac{\nabla' \times \boldsymbol{F}(\boldsymbol{r}')}{|\boldsymbol{r} - \boldsymbol{r}'|} dV' + \frac{1}{4\pi} \oint_S \frac{\boldsymbol{n} \times \boldsymbol{F}(\boldsymbol{r}')}{|\boldsymbol{r} - \boldsymbol{r}'|} dS'
\end{equation}
\end{itemize}
Hier bezeichnet $\boldsymbol{n}$ den nach aussen gerichteten Normalenvektor auf der Oberfläche $S$.

\subsection{Bedingungen und Eindeutigkeit
\label{helmholtz:subsection:Bedingungen_Eindeutigkeit}}

\subsubsection{Voraussetzungen für die Anwendbarkeit}
Damit die Zerlegung korrekt durchgeführt werden kann, muss das Vektorfeld $\boldsymbol{F}$ folgende Bedingungen erfüllen:

\begin{itemize}
\item Glattheit: $\boldsymbol{F}$ muss stetig differenzierbar sein in dem betrachteten Gebiet.
\item Abfallverhalten: $\boldsymbol{F}$ muss im Unendlichen schneller als $\frac{1}{r}$ abfallen, d.h.
\begin{equation}
\lim_{r \to \infty} r|\boldsymbol{F}(\boldsymbol{r})| = 0,
\end{equation}
wobei $r = |\boldsymbol{r}|$ der Abstand vom Ursprung ist.
\end{itemize}
Diese Bedingungen stellen sicher, dass die Integrale in der Greenschen Formulierung konvergieren und die Zerlegung eindeutig ist.

\subsubsection{Eindeutigkeit der Zerlegung
\label{helmholtz:subsection:Bedingungen_onlyEindeutigkeit}}

Die Eindeutigkeit der Helmholtz-Zerlegung hängt von den Randbedingungen ab:

\begin{itemize}
\item Für unbeschränkte Gebiete: Die Zerlegung ist eindeutig, wenn das Vektorfeld im Unendlichen gegen null geht. Diese Bedingung stellt sicher, dass bestimmte Oberflächenintegrale bei der Herleitung der Zerlegung verschwinden \cite{wiki:helmholtz}.

\item Für beschränkte Gebiete: Die Eindeutigkeit erfordert zusätzliche Randbedingungen. Obwohl das Vektorfeld auch als Summe eines irrotationalen und eines solenoidalen Anteils geschrieben werden kann, ist für eine eindeutige Lösung die Festlegung von Randbedingungen notwendig \cite{wiki:helmholtz}. Typischerweise sind dies:
  \begin{itemize}
    \item Festlegung der Normalkomponente des irrotationalen Teils auf dem Rand.
    \item Festlegung der Tangentialkomponente des solenoidalen Teils auf dem Rand.
  \end{itemize}
\end{itemize}

\subsubsection{Orthogonalität der Komponenten}

Eine wichtige Eigenschaft der Helmholtz-Zerlegung ist die Orthogonalität der beiden Komponenten. Für ein Vektorfeld $\boldsymbol{F} = \boldsymbol{F}_{\text{irr}} + \boldsymbol{F}_{\text{sol}}$ gilt unter geeigneten Randbedingungen:
\begin{equation}
\int_V \boldsymbol{F}_{\text{irr}} \cdot \boldsymbol{F}_{\text{sol}} \, dV = 0.
\end{equation}
Das Integral ist null, weil es mithilfe des Gaussschen Integralsatzes in ein Oberflächenintegral umgewandelt werden kann, das unter den für die Helmholtz-Zerlegung Randbedingungen, wie in \ref{helmholtz:subsection:Bedingungen_onlyEindeutigkeit} beschrieben, verschwindet.
 
In physikalischen Anwendungen, wie beispielsweise in der Akustik, bedeutet diese mathematische Orthogonalität, dass die beiden Feldkomponenten unterschiedliche physikalische Phänomene beschreiben, die unabhängig voneinander analysiert werden können. Mehr dazu wird im Unterkapitel \ref{tab:helmholtz:Energie_Interpretation} erläutert.


